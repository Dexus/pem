language: node_js
sudo: required
cache:
  directories:
    - node_modules
notifications:
  email:
    recipients:
      - github@josef-froehle.de
    on_success: change
    on_failure: change
node_js:
  - '8'
  - '6'
  - '4'
env:
  - LIBRARY: openssl
    VERSION: 0.9.8zh
    OPENSSL_DIR: /openssl
    TARGET: x86_64-unknown-linux-gnu
  - LIBRARY: openssl
    VERSION: 1.0.1u
    OPENSSL_DIR: /openssl
    TARGET: x86_64-unknown-linux-gnu
  - LIBRARY: openssl
    VERSION: 1.0.2l
    OPENSSL_DIR: /openssl
    TARGET: x86_64-unknown-linux-gnu
  - LIBRARY: openssl
    VERSION: 1.1.0f
    OPENSSL_DIR: /openssl
    TARGET: x86_64-unknown-linux-gnu
  - LIBRARY: libressl
    VERSION: 2.4.4
    OPENSSL_DIR: /openssl
    TARGET: x86_64-unknown-linux-gnu
  - LIBRARY: libressl
    VERSION: 2.5.5
    OPENSSL_DIR: /openssl
    TARGET: x86_64-unknown-linux-gnu
  - LIBRARY: libressl
    VERSION: 2.6.1
    OPENSSL_DIR: /openssl
    TARGET: x86_64-unknown-linux-gnu
before_install:
  - npm install -g grunt-cli
before_script:
  - npm prune
script:
  - "./test_build_openssl.sh"
  - grunt
after_success:
  - npm run semantic-release
branches:
  except:
    - /^v\d+\.\d+\.\d+$/
