<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon Jan 31 16:14:37 2022 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>VERIFY</title>

</head>
<body>

<h1 align="center">VERIFY</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#COMMAND OPTIONS">COMMAND OPTIONS</a><br>
<a href="#VERIFY OPERATION">VERIFY OPERATION</a><br>
<a href="#DIAGNOSTICS">DIAGNOSTICS</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#HISTORY">HISTORY</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">verify -
Utility to verify certificates.</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>openssl
verify</b> [<b>-CApath directory</b>] [<b>-CAfile file</b>]
[<b>-purpose purpose</b>] [<b>-policy arg</b>]
[<b>-ignore_critical</b>] [<b>-crl_check</b>]
[<b>-crl_check_all</b>] [<b>-policy_check</b>]
[<b>-explicit_policy</b>] [<b>-inhibit_any</b>]
[<b>-inhibit_map</b>] [<b>-x509_strict</b>]
[<b>-extended_crl</b>] [<b>-use_deltas</b>]
[<b>-policy_print</b>] [<b>-no_alt_chains</b>]
[<b>-allow_proxy_certs</b>] [<b>-untrusted file</b>]
[<b>-help</b>] [<b>-issuer_checks</b>] [<b>-attime
timestamp</b>] [<b>-verbose</b>] [<b>-</b>]
[certificates]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<b>verify</b> command verifies certificate chains.</p>

<h2>COMMAND OPTIONS
<a name="COMMAND OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>-CApath
directory</b></p>

<p style="margin-left:17%;">A directory of trusted
certificates. The certificates should have names of the
form: hash.0 or have symbolic links to them of this form
(&quot;hash&quot; is the hashed certificate subject name:
see the <b>-hash</b> option of the <b>x509</b> utility).
Under Unix the <b>c_rehash</b> script will automatically
create symbolic links to a directory of certificates.</p>

<p style="margin-left:11%;"><b>-CAfile file</b> A file of
trusted certificates. The file should contain <br>
multiple certificates in <small>PEM</small> format
concatenated together. <b><br>
-untrusted file</b></p>

<p style="margin-left:17%;">A file of untrusted
certificates. The file should contain multiple certificates
in <small>PEM</small> format concatenated together.</p>

<p style="margin-left:11%;"><b>-purpose purpose</b></p>

<p style="margin-left:17%;">The intended use for the
certificate. If this option is not specified, <b>verify</b>
will not consider certificate purpose during chain
verification. Currently accepted uses are <b>sslclient</b>,
<b>sslserver</b>, <b>nssslserver</b>, <b>smimesign</b>,
<b>smimeencrypt</b>. See the <b><small>VERIFY
OPERATION</small></b> section for more information.</p>

<p style="margin-left:11%;"><b>-help</b></p>

<p style="margin-left:17%;">Print out a usage message.</p>

<p style="margin-left:11%;"><b>-verbose</b></p>

<p style="margin-left:17%;">Print extra information about
the operations being performed.</p>

<p style="margin-left:11%;"><b>-issuer_checks</b></p>

<p style="margin-left:17%;">Print out diagnostics relating
to searches for the issuer certificate of the current
certificate. This shows why each candidate issuer
certificate was rejected. The presence of rejection messages
does not itself imply that anything is wrong; during the
normal verification process, several rejections may take
place.</p>

<p style="margin-left:11%;"><b>-attime timestamp</b></p>

<p style="margin-left:17%;">Perform validation checks using
time specified by <b>timestamp</b> and not current system
time. <b>timestamp</b> is the number of seconds since
01.01.1970 ( <small>UNIX</small> time).</p>

<p style="margin-left:11%;"><b>-policy arg</b></p>

<p style="margin-left:17%;">Enable policy processing and
add <b>arg</b> to the user-initial-policy-set (see
<small>RFC5280</small> ). The policy <b>arg</b> can be an
object name an <small>OID</small> in numeric form. This
argument can appear more than once.</p>

<p style="margin-left:11%;"><b>-policy_check</b></p>

<p style="margin-left:17%;">Enables certificate policy
processing.</p>

<p style="margin-left:11%;"><b>-explicit_policy</b></p>

<p style="margin-left:17%;">Set policy variable
require-explicit-policy (see <small>RFC5280</small> ).</p>

<p style="margin-left:11%;"><b>-inhibit_any</b></p>

<p style="margin-left:17%;">Set policy variable
inhibit-any-policy (see <small>RFC5280</small> ).</p>

<p style="margin-left:11%;"><b>-inhibit_map</b></p>

<p style="margin-left:17%;">Set policy variable
inhibit-policy-mapping (see <small>RFC5280</small> ).</p>

<p style="margin-left:11%;"><b>-no_alt_chains</b></p>

<p style="margin-left:17%;">When building a certificate
chain, if the first certificate chain found is not trusted,
then OpenSSL will continue to check to see if an alternative
chain can be found that is trusted. With this option that
behaviour is suppressed so that only the first chain found
is ever used. Using this option will force the behaviour to
match that of previous OpenSSL versions.</p>

<p style="margin-left:11%;"><b>-allow_proxy_certs</b></p>

<p style="margin-left:17%;">Allow the verification of proxy
certificates.</p>

<p style="margin-left:11%;"><b>-policy_print</b></p>

<p style="margin-left:17%;">Print out diagnostics related
to policy processing.</p>

<p style="margin-left:11%;"><b>-crl_check</b></p>

<p style="margin-left:17%;">Checks end entity certificate
validity by attempting to look up a valid
<small>CRL.</small> If a valid <small>CRL</small> cannot be
found an error occurs.</p>

<p style="margin-left:11%;"><b>-crl_check_all</b></p>

<p style="margin-left:17%;">Checks the validity of
<b>all</b> certificates in the chain by attempting to look
up valid CRLs.</p>

<p style="margin-left:11%;"><b>-ignore_critical</b></p>

<p style="margin-left:17%;">Normally if an unhandled
critical extension is present which is not supported by
OpenSSL the certificate is rejected (as required by
<small>RFC5280</small> ). If this option is set critical
extensions are ignored.</p>

<p style="margin-left:11%;"><b>-x509_strict</b></p>

<p style="margin-left:17%;">For strict X.509 compliance,
disable non-compliant workarounds for broken
certificates.</p>

<p style="margin-left:11%;"><b>-extended_crl</b></p>

<p style="margin-left:17%;">Enable extended
<small>CRL</small> features such as indirect CRLs and
alternate <small>CRL</small> signing keys.</p>

<p style="margin-left:11%;"><b>-use_deltas</b></p>

<p style="margin-left:17%;">Enable support for delta
CRLs.</p>

<p style="margin-left:11%;"><b>-check_ss_sig</b></p>

<p style="margin-left:17%;">Verify the signature on the
self-signed root <small>CA.</small> This is disabled by
default because it doesn&rsquo;t add any security.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p><b>-</b></p></td>
<td width="5%"></td>
<td width="83%">


<p>Indicates the last option. All arguments following this
are assumed to be certificate files. This is useful if the
first certificate filename begins with a <b>-</b>.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>certificates</b></p>

<p style="margin-left:17%;">One or more certificates to
verify. If no certificates are given, <b>verify</b> will
attempt to read a certificate from standard input.
Certificates must be in <small>PEM</small> format.</p>

<h2>VERIFY OPERATION
<a name="VERIFY OPERATION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<b>verify</b> program uses the same functions as the
internal <small>SSL</small> and S/MIME verification,
therefore this description applies to these verify
operations too.</p>

<p style="margin-left:11%; margin-top: 1em">There is one
crucial difference between the verify operations performed
by the <b>verify</b> program: wherever possible an attempt
is made to continue after an error whereas normally the
verify operation would halt on the first error. This allows
all the problems with a certificate chain to be
determined.</p>

<p style="margin-left:11%; margin-top: 1em">The verify
operation consists of a number of separate steps.</p>

<p style="margin-left:11%; margin-top: 1em">Firstly a
certificate chain is built up starting from the supplied
certificate and ending in the root <small>CA.</small> It is
an error if the whole chain cannot be built up. The chain is
built up by looking up the issuers certificate of the
current certificate. If a certificate is found which is its
own issuer it is assumed to be the root
<small>CA.</small></p>

<p style="margin-left:11%; margin-top: 1em">The process of
&rsquo;looking up the issuers certificate&rsquo; itself
involves a number of steps. In versions of OpenSSL before
0.9.5a the first certificate whose subject name matched the
issuer of the current certificate was assumed to be the
issuers certificate. In OpenSSL 0.9.6 and later all
certificates whose subject name matches the issuer name of
the current certificate are subject to further tests. The
relevant authority key identifier components of the current
certificate (if present) must match the subject key
identifier (if present) and issuer and serial number of the
candidate issuer, in addition the keyUsage extension of the
candidate issuer (if present) must permit certificate
signing.</p>

<p style="margin-left:11%; margin-top: 1em">The lookup
first looks in the list of untrusted certificates and if no
match is found the remaining lookups are from the trusted
certificates. The root <small>CA</small> is always looked up
in the trusted certificate list: if the certificate to
verify is a root certificate then an exact match must be
found in the trusted list.</p>

<p style="margin-left:11%; margin-top: 1em">The second
operation is to check every untrusted certificate&rsquo;s
extensions for consistency with the supplied purpose. If the
<b>-purpose</b> option is not included then no checks are
done. The supplied or &quot;leaf&quot; certificate must have
extensions compatible with the supplied purpose and all
other certificates must also be valid <small>CA</small>
certificates. The precise extensions required are described
in more detail in the <b><small>CERTIFICATE
EXTENSIONS</small></b> section of the <b>x509</b>
utility.</p>

<p style="margin-left:11%; margin-top: 1em">The third
operation is to check the trust settings on the root
<small>CA.</small> The root <small>CA</small> should be
trusted for the supplied purpose. For compatibility with
previous versions of SSLeay and OpenSSL a certificate with
no trust settings is considered to be valid for all
purposes.</p>

<p style="margin-left:11%; margin-top: 1em">The final
operation is to check the validity of the certificate chain.
The validity period is checked against the current system
time and the notBefore and notAfter dates in the
certificate. The certificate signatures are also checked at
this point.</p>

<p style="margin-left:11%; margin-top: 1em">If all
operations complete successfully then certificate is
considered valid. If any operation fails then the
certificate is not valid.</p>

<h2>DIAGNOSTICS
<a name="DIAGNOSTICS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">When a verify
operation fails the output messages can be somewhat cryptic.
The general form of the error message is:</p>

<p style="margin-left:11%; margin-top: 1em">server.pem:
/C=AU/ST=Queensland/O=CryptSoft Pty Ltd/CN=Test CA (1024
bit) <br>
error 24 at 1 depth lookup:invalid CA certificate</p>

<p style="margin-left:11%; margin-top: 1em">The first line
contains the name of the certificate being verified followed
by the subject name of the certificate. The second line
contains the error number and the depth. The depth is number
of the certificate being verified when a problem was
detected starting with zero for the certificate being
verified itself then 1 for the <small>CA</small> that signed
the certificate and so on. Finally a text version of the
error number is presented.</p>

<p style="margin-left:11%; margin-top: 1em">An exhaustive
list of the error codes and messages is shown below, this
also includes the name of the error code as defined in the
header file x509_vfy.h Some of the error codes are defined
but never returned: these are described as
&quot;unused&quot;. <b><br>
0 X509_V_OK: ok</b></p>

<p style="margin-left:17%;">the operation was
successful.</p>

<p style="margin-left:11%;"><b>2
X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT: unable to get issuer
<br>
certificate</b></p>

<p style="margin-left:17%;">the issuer certificate of a
looked up certificate could not be found. This normally
means the list of trusted certificates is not complete.</p>

<p style="margin-left:11%;"><b>3
X509_V_ERR_UNABLE_TO_GET_CRL: unable to get certificate
<small>CRL</small></b></p>

<p style="margin-left:17%;">the <small>CRL</small> of a
certificate could not be found.</p>

<p style="margin-left:11%;"><b>4
X509_V_ERR_UNABLE_TO_DECRYPT_CERT_SIGNATURE: unable to
decrypt <br>
certificate&rsquo;s signature</b></p>

<p style="margin-left:17%;">the certificate signature could
not be decrypted. This means that the actual signature value
could not be determined rather than it not matching the
expected value, this is only meaningful for
<small>RSA</small> keys.</p>

<p style="margin-left:11%;"><b>5
X509_V_ERR_UNABLE_TO_DECRYPT_CRL_SIGNATURE: unable to
decrypt <small>CRL</small> &rsquo;s <br>
signature</b></p>

<p style="margin-left:17%;">the <small>CRL</small>
signature could not be decrypted: this means that the actual
signature value could not be determined rather than it not
matching the expected value. Unused.</p>

<p style="margin-left:11%;"><b>6
X509_V_ERR_UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY: unable to
decode <br>
issuer public key</b></p>

<p style="margin-left:17%;">the public key in the
certificate SubjectPublicKeyInfo could not be read.</p>

<p style="margin-left:11%;"><b>7
X509_V_ERR_CERT_SIGNATURE_FAILURE: certificate signature
failure</b></p>

<p style="margin-left:17%;">the signature of the
certificate is invalid.</p>

<p style="margin-left:11%;"><b>8
X509_V_ERR_CRL_SIGNATURE_FAILURE: <small>CRL</small>
signature failure</b></p>

<p style="margin-left:17%;">the signature of the
certificate is invalid.</p>

<p style="margin-left:11%;"><b>9
X509_V_ERR_CERT_NOT_YET_VALID: certificate is not yet
valid</b></p>

<p style="margin-left:17%;">the certificate is not yet
valid: the notBefore date is after the current time.</p>

<p style="margin-left:11%;"><b>10
X509_V_ERR_CERT_HAS_EXPIRED: certificate has expired</b></p>

<p style="margin-left:17%;">the certificate has expired:
that is the notAfter date is before the current time.</p>

<p style="margin-left:11%;"><b>11
X509_V_ERR_CRL_NOT_YET_VALID: <small>CRL</small> is not yet
valid</b></p>

<p style="margin-left:17%;">the <small>CRL</small> is not
yet valid.</p>

<p style="margin-left:11%;"><b>12
X509_V_ERR_CRL_HAS_EXPIRED: <small>CRL</small> has
expired</b></p>

<p style="margin-left:17%;">the <small>CRL</small> has
expired.</p>

<p style="margin-left:11%;"><b>13
X509_V_ERR_ERROR_IN_CERT_NOT_BEFORE_FIELD: format error in
<br>
certificate&rsquo;s notBefore field</b></p>

<p style="margin-left:17%;">the certificate notBefore field
contains an invalid time.</p>

<p style="margin-left:11%;"><b>14
X509_V_ERR_ERROR_IN_CERT_NOT_AFTER_FIELD: format error in
<br>
certificate&rsquo;s notAfter field</b></p>

<p style="margin-left:17%;">the certificate notAfter field
contains an invalid time.</p>

<p style="margin-left:11%;"><b>15
X509_V_ERR_ERROR_IN_CRL_LAST_UPDATE_FIELD: format error in
<small>CRL</small> &rsquo;s <br>
lastUpdate field</b></p>

<p style="margin-left:17%;">the <small>CRL</small>
lastUpdate field contains an invalid time.</p>

<p style="margin-left:11%;"><b>16
X509_V_ERR_ERROR_IN_CRL_NEXT_UPDATE_FIELD: format error in
<small>CRL</small> &rsquo;s <br>
nextUpdate field</b></p>

<p style="margin-left:17%;">the <small>CRL</small>
nextUpdate field contains an invalid time.</p>

<p style="margin-left:11%;"><b>17 X509_V_ERR_OUT_OF_MEM:
out of memory</b></p>

<p style="margin-left:17%;">an error occurred trying to
allocate memory. This should never happen.</p>

<p style="margin-left:11%;"><b>18
X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT: self signed
certificate</b></p>

<p style="margin-left:17%;">the passed certificate is self
signed and the same certificate cannot be found in the list
of trusted certificates.</p>

<p style="margin-left:11%;"><b>19
X509_V_ERR_SELF_SIGNED_CERT_IN_CHAIN: self signed
certificate in <br>
certificate chain</b></p>

<p style="margin-left:17%;">the certificate chain could be
built up using the untrusted certificates but the root could
not be found locally.</p>

<p style="margin-left:11%;"><b>20
X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY: unable to get
local <br>
issuer certificate</b></p>

<p style="margin-left:17%;">the issuer certificate could
not be found: this occurs if the issuer certificate of an
untrusted certificate cannot be found.</p>

<p style="margin-left:11%;"><b>21
X509_V_ERR_UNABLE_TO_VERIFY_LEAF_SIGNATURE: unable to verify
the <br>
first certificate</b></p>

<p style="margin-left:17%;">no signatures could be verified
because the chain contains only one certificate and it is
not self signed.</p>

<p style="margin-left:11%;"><b>22
X509_V_ERR_CERT_CHAIN_TOO_LONG: certificate chain too
long</b></p>

<p style="margin-left:17%;">the certificate chain length is
greater than the supplied maximum depth. Unused.</p>

<p style="margin-left:11%;"><b>23 X509_V_ERR_CERT_REVOKED:
certificate revoked</b></p>

<p style="margin-left:17%;">the certificate has been
revoked.</p>

<p style="margin-left:11%;"><b>24 X509_V_ERR_INVALID_CA:
invalid <small>CA</small> certificate</b></p>

<p style="margin-left:17%;">a <small>CA</small> certificate
is invalid. Either it is not a <small>CA</small> or its
extensions are not consistent with the supplied purpose.</p>

<p style="margin-left:11%;"><b>25
X509_V_ERR_PATH_LENGTH_EXCEEDED: path length constraint
exceeded</b></p>

<p style="margin-left:17%;">the basicConstraints pathlength
parameter has been exceeded.</p>

<p style="margin-left:11%;"><b>26
X509_V_ERR_INVALID_PURPOSE: unsupported certificate
purpose</b></p>

<p style="margin-left:17%;">the supplied certificate cannot
be used for the specified purpose.</p>

<p style="margin-left:11%;"><b>27
X509_V_ERR_CERT_UNTRUSTED: certificate not trusted</b></p>

<p style="margin-left:17%;">the root <small>CA</small> is
not marked as trusted for the specified purpose.</p>

<p style="margin-left:11%;"><b>28 X509_V_ERR_CERT_REJECTED:
certificate rejected</b></p>

<p style="margin-left:17%;">the root <small>CA</small> is
marked to reject the specified purpose.</p>

<p style="margin-left:11%;"><b>29
X509_V_ERR_SUBJECT_ISSUER_MISMATCH: subject issuer
mismatch</b></p>

<p style="margin-left:17%;">the current candidate issuer
certificate was rejected because its subject name did not
match the issuer name of the current certificate. Only
displayed when the <b>-issuer_checks</b> option is set.</p>

<p style="margin-left:11%;"><b>30
X509_V_ERR_AKID_SKID_MISMATCH: authority and subject key
identifier <br>
mismatch</b></p>

<p style="margin-left:17%;">the current candidate issuer
certificate was rejected because its subject key identifier
was present and did not match the authority key identifier
current certificate. Only displayed when the
<b>-issuer_checks</b> option is set.</p>

<p style="margin-left:11%;"><b>31
X509_V_ERR_AKID_ISSUER_SERIAL_MISMATCH: authority and issuer
serial <br>
number mismatch</b></p>

<p style="margin-left:17%;">the current candidate issuer
certificate was rejected because its issuer name and serial
number was present and did not match the authority key
identifier of the current certificate. Only displayed when
the <b>-issuer_checks</b> option is set.</p>

<p style="margin-left:11%;"><b>32
X509_V_ERR_KEYUSAGE_NO_CERTSIGN:key usage does not include
<br>
certificate signing</b></p>

<p style="margin-left:17%;">the current candidate issuer
certificate was rejected because its keyUsage extension does
not permit certificate signing.</p>

<p style="margin-left:11%;"><b>50
X509_V_ERR_APPLICATION_VERIFICATION: application
verification <br>
failure</b></p>

<p style="margin-left:17%;">an application specific error.
Unused.</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Although the
issuer checks are a considerable improvement over the old
technique they still suffer from limitations in the
underlying X509_LOOKUP <small>API.</small> One consequence
of this is that trusted certificates with matching subject
name must either appear in a file (as specified by the
<b>-CAfile</b> option) or a directory (as specified by
<b>-CApath</b>. If they occur in both then only the
certificates in the file will be recognised.</p>

<p style="margin-left:11%; margin-top: 1em">Previous
versions of OpenSSL assume certificates with matching
subject name are identical and mishandled them.</p>

<p style="margin-left:11%; margin-top: 1em">Previous
versions of this documentation swapped the meaning of the
<b>X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT</b> and <b>20
X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY</b> error
codes.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>x509</b>(1)</p>

<h2>HISTORY
<a name="HISTORY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
-no_alt_chains options was first added to OpenSSL 1.0.1n and
1.0.2b.</p>
<hr>
</body>
</html>
