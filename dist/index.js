require('./sourcemap-register.js');(()=>{var e={143:(e,r,t)=>{const{isexe:n,sync:i}=t(200);const{join:s,delimiter:o,sep:a,posix:c}=t(17);const u=process.platform==="win32";const f=new RegExp(`[${c.sep}${a===c.sep?"":a}]`.replace(/(\\)/g,"\\$1"));const p=new RegExp(`^\\.${f.source}`);const getNotFoundError=e=>Object.assign(new Error(`not found: ${e}`),{code:"ENOENT"});const getPathInfo=(e,{path:r=process.env.PATH,pathExt:t=process.env.PATHEXT,delimiter:n=o})=>{const i=e.match(f)?[""]:[...u?[process.cwd()]:[],...(r||"").split(n)];if(u){const r=t||[".EXE",".CMD",".BAT",".COM"].join(n);const s=r.split(n).flatMap((e=>[e,e.toLowerCase()]));if(e.includes(".")&&s[0]!==""){s.unshift("")}return{pathEnv:i,pathExt:s,pathExtExe:r}}return{pathEnv:i,pathExt:[""]}};const getPathPart=(e,r)=>{const t=/^".*"$/.test(e)?e.slice(1,-1):e;const n=!t&&p.test(r)?r.slice(0,2):"";return n+s(t,r)};const which=async(e,r={})=>{const{pathEnv:t,pathExt:i,pathExtExe:s}=getPathInfo(e,r);const o=[];for(const a of t){const t=getPathPart(a,e);for(const e of i){const i=t+e;const a=await n(i,{pathExt:s,ignoreErrors:true});if(a){if(!r.all){return i}o.push(i)}}}if(r.all&&o.length){return o}if(r.nothrow){return null}throw getNotFoundError(e)};const whichSync=(e,r={})=>{const{pathEnv:t,pathExt:n,pathExtExe:s}=getPathInfo(e,r);const o=[];for(const a of t){const t=getPathPart(a,e);for(const e of n){const n=t+e;const a=i(n,{pathExt:s,ignoreErrors:true});if(a){if(!r.all){return n}o.push(n)}}}if(r.all&&o.length){return o}if(r.nothrow){return null}throw getNotFoundError(e)};e.exports=which;which.sync=whichSync},81:e=>{"use strict";e.exports=require("child_process")},113:e=>{"use strict";e.exports=require("crypto")},147:e=>{"use strict";e.exports=require("fs")},292:e=>{"use strict";e.exports=require("fs/promises")},808:e=>{"use strict";e.exports=require("net")},5:e=>{"use strict";e.exports=require("node:crypto")},37:e=>{"use strict";e.exports=require("os")},17:e=>{"use strict";e.exports=require("path")},991:(e,r,t)=>{"use strict";const{randomBytes:n}=t(113);const i=t(147);const s=t(17);const{tmpdir:o}=t(37);const a=t(649);const c=t(702);const u=t(214);const f=u.createCSR;const p=24*60*60*1e3;class CertificateAuthority{constructor(e={}){if(!e.key){throw new Error("CA private key is required")}if(!e.certificate){throw new Error("CA certificate is required")}this.key=e.key.toString();this.certificate=e.certificate.toString();this.password=e.keyPassword||e.password||null;this.chain=Array.isArray(e.chain)?e.chain.map((function(e){return e.toString()})):[];this.defaultDays=Number.isFinite(e.defaultDays)&&e.defaultDays>0?Number(e.defaultDays):7}issueCertificate(e,r){if(!r&&typeof e==="function"){r=e;e=undefined}if(!r){return new Promise(((r,t)=>{this.issueCertificate(e,(function(e,n){if(e){return t(e)}r(n)}))}))}const t=Object.assign({},e||{});const handleResult=(e,n)=>{if(e){return r(e)}const i={csr:t.csr,clientKey:t.clientKey||"",certificate:n.certificate,caCertificate:this.certificate,caChain:[this.certificate].concat(this.chain),serial:n.serial,validity:n.validity};r(null,i)};const signWithOptions=()=>{this._signCertificate(t,handleResult)};if(t.csr){signWithOptions();return}f(t,((e,n)=>{if(e){return r(e)}t.csr=n.csr;t.clientKey=n.clientKey;if(n.config){t.config=n.config}signWithOptions()}))}_signCertificate(e,r){let t;try{t=resolveValidity(e,this.defaultDays)}catch(e){return r(e)}let n;try{n=formatSerial(e.serial)}catch(e){return r(e)}const u=n.slice(2).toUpperCase()||"1";const f=[];let p;let l;try{p=i.mkdtempSync(s.join(o(),"pem-ca-"));i.mkdirSync(s.join(p,"certs"));i.writeFileSync(s.join(p,"index.txt"),"");i.writeFileSync(s.join(p,"serial"),u+"\n");l=s.join(p,"issued.pem")}catch(e){const t=removeDirectory(p);return r(t||e)}const d=buildCaConfig(p,e.hash||"sha256");const h=["ca","-batch","-config","--TMPFILE--","-keyfile","--TMPFILE--","-cert","--TMPFILE--","-md",e.hash||"sha256","-startdate",t.asn1.start,"-enddate",t.asn1.end,"-in","--TMPFILE--","-out",l];const m=[d,this.key,this.certificate,e.csr];if(this.password){a.createPasswordFile({cipher:"",password:this.password,passType:"in"},h,f)}if(e.config){h.push("-extensions");h.push("v3_req");h.push("-extfile");h.push("--TMPFILE--");m.push(e.config)}else if(e.extFile){h.push("-extfile");h.push(e.extFile)}const finalize=(e,i)=>{const removePasswordFiles=s=>{const o=removeDirectory(p);const a=e||s||o;if(a){return r(a)}r(null,{certificate:i,serial:n,validity:t.dates})};if(f.length){a.deleteTempFiles(f,removePasswordFiles)}else{removePasswordFiles(null)}};c.spawnWrapper(h,m,(e=>{if(e){return finalize(e)}let r;try{r=i.readFileSync(l,"utf-8")}catch(e){return finalize(e)}finalize(null,r)}))}}function buildCaConfig(e,r){const t=["[ ca ]","default_ca = pem_ca","","[ pem_ca ]","dir = "+e,"database = "+s.join(e,"index.txt"),"serial = "+s.join(e,"serial"),"new_certs_dir = "+s.join(e,"certs"),"default_md = "+r,"policy = pem_ca_policy","x509_extensions = pem_ca_extensions","copy_extensions = copy","unique_subject = no","","[ pem_ca_policy ]","commonName = supplied","stateOrProvinceName = optional","countryName = optional","organizationName = optional","organizationalUnitName = optional","emailAddress = optional","","[ pem_ca_extensions ]","basicConstraints = CA:FALSE","keyUsage = digitalSignature, keyEncipherment","extendedKeyUsage = serverAuth, clientAuth"];return t.join("\n")}function removeDirectory(e){if(!e){return null}try{i.rmdirSync(e,{recursive:true});return null}catch(e){if(e&&e.code==="ENOENT"){return null}return e}}function formatSerial(e){if(e===undefined||e===null){return"0x"+n(20).toString("hex")}if(Buffer.isBuffer(e)){return"0x"+e.toString("hex").padStart(40,"0").slice(-40)}if(typeof e==="number"){const r=e.toString(16);return"0x"+r.padStart(40,"0").slice(-40)}let r;if(typeof e==="string"){if(e.startsWith("0x")||e.startsWith("0X")){r=e.slice(2)}else if(a.isHex(e)){r=e}else{r=a.toHex(e)}}else{r=a.toHex(String(e))}r=(r||"").replace(/[^0-9a-f]/gi,"");if(!r){throw new Error("Unable to format certificate serial number")}r=r.toLowerCase();return"0x"+r.padStart(40,"0").slice(-40)}function resolveValidity(e,r){const t=normalizeDate(e.startDate)||new Date;let n;if(e.endDate){n=normalizeDate(e.endDate)}else if(e.days){const r=Number(e.days);if(!Number.isFinite(r)||r<=0){throw new Error("Certificate validity days must be a positive number")}n=new Date(t.getTime()+r*p)}else{n=new Date(t.getTime()+r*p)}if(!n||!(n instanceof Date)||Number.isNaN(n.getTime())){throw new Error("Invalid certificate end date")}if(n.getTime()<=t.getTime()){throw new Error("Certificate end date must be after start date")}const i=formatAsn1Date(t);const s=formatAsn1Date(n);return{asn1:{start:i,end:s},dates:{start:parseAsn1Date(i),end:parseAsn1Date(s)}}}function normalizeDate(e){if(!e){return null}if(e instanceof Date){if(Number.isNaN(e.getTime())){throw new Error("Invalid date value")}return e}if(typeof e==="number"){const r=new Date(e);if(Number.isNaN(r.getTime())){throw new Error("Invalid date value")}return r}if(typeof e==="string"){if(/^\d{12}Z$/.test(e)||/^\d{14}Z$/.test(e)){return parseAsn1Date(e)}const r=new Date(e);if(Number.isNaN(r.getTime())){throw new Error("Invalid date string")}return r}throw new Error("Unsupported date value")}function formatAsn1Date(e){const pad=e=>{let r=String(e);while(r.length<2){r="0"+r}return r};const r=pad(e.getUTCMonth()+1)+pad(e.getUTCDate())+pad(e.getUTCHours())+pad(e.getUTCMinutes())+pad(e.getUTCSeconds());const t=e.getUTCFullYear();if(t>=1950&&t<=2049){return pad(t%100)+r+"Z"}return t.toString()+r+"Z"}function parseAsn1Date(e){const r=e.replace(/\s+/g,"");if(!/^\d{12}Z$/.test(r)&&!/^\d{14}Z$/.test(r)){throw new Error("Invalid ASN.1 date value")}let t;let n;if(r.length===13){const e=Number(r.slice(0,2));n=e>=50?1900+e:2e3+e;t=2}else{n=Number(r.slice(0,4));t=4}const i=Number(r.slice(t,t+2))-1;const s=Number(r.slice(t+2,t+4));const o=Number(r.slice(t+4,t+6));const a=Number(r.slice(t+6,t+8));const c=Number(r.slice(t+8,t+10));const u=new Date(Date.UTC(n,i,s,o,a,c));if(Number.isNaN(u.getTime())){throw new Error("Invalid ASN.1 date value")}return u}e.exports=CertificateAuthority},254:(e,r,t)=>{"use strict";var n=t(702);var i=t(649);var{debug:s}=t(762);e.exports.PEM2DER=function(e,r,t,i){if(!i&&typeof t==="function"){i=t;t="x509"}var s=[t,"-outform","der","-in",e,"-out",r];n.spawnWrapper(s,false,(function(e,r){if(e){i(e)}else{i(null,r===0)}}))};e.exports.DER2PEM=function(e,r,t,i){if(!i&&typeof t==="function"){i=t;t="x509"}var s=[t,"-inform","der","-in",e,"-out",r];n.spawnWrapper(s,false,(function(e,r){if(e){i(e)}else{i(null,r===0)}}))};e.exports.PEM2P7B=function(e,r,t){var i=["crl2pkcs7","-nocrl","-certfile",e.cert,"-out",r];if(e.ca){if(!Array.isArray(e.ca)){e.ca=[e.ca]}e.ca.forEach((function(e){i.push("-certfile");i.push(e)}))}n.spawnWrapper(i,false,(function(e,r){if(e){t(e)}else{t(null,r===0)}}))};e.exports.P7B2PEM=function(e,r,t){var i=["pkcs7","-print_certs","-in",e,"-out",r];n.spawnWrapper(i,false,(function(e,r){if(e){t(e)}else{t(null,r===0)}}))};e.exports.PEM2PFX=function(e,r,t,s){var o=["pkcs12","-export","-out",r,"-inkey",e.key,"-in",e.cert];if(e.ca){if(!Array.isArray(e.ca)){e.ca=[e.ca]}e.ca.forEach((function(e){o.push("-certfile");o.push(e)}))}var a=[];i.createPasswordFile({cipher:"",password:t,passType:"in"},o,a);i.createPasswordFile({cipher:"",password:t,passType:"out"},o,a);n.spawnWrapper(o,false,(function(e,r){function done(e){if(e){s(e)}else{s(null,r===0)}}i.deleteTempFiles(a,(function(r){done(e||r)}))}))};e.exports.PFX2PEM=function(e,r,t,s){var o=["pkcs12","-in",e,"-out",r,"-nodes"];var a=[];i.createPasswordFile({cipher:"",password:t,passType:"in"},o,a);i.createPasswordFile({cipher:"",password:t,passType:"out"},o,a);n.spawnWrapper(o,false,(function(e,r){function done(e){if(e){s(e)}else{s(null,r===0)}}i.deleteTempFiles(a,(function(r){done(e||r)}))}))};e.exports.P7B2PFX=function(e,r,t,o){var a=e.cert.replace(/\.[^.]+$/,".cer");var c=["pkcs7","-print_certs","-in",e.cert,"-out",a];n.spawnWrapper(c,false,(function(c,u){s("P7B2PFX",{error:c,code:u});if(c){o(c)}else{var f=["pkcs12","-export","-in",a,"-inkey",e.key,"-out",r];if(e.ca){if(!Array.isArray(e.ca)){e.ca=[e.ca]}e.ca.forEach((function(e){f.push("-certfile");f.push(e)}))}var p=[a];i.createPasswordFile({cipher:"",password:t,passType:"in"},f,p);i.createPasswordFile({cipher:"",password:t,passType:"out"},f,p);n.spawnWrapper(f,false,(function(e,r){function done(e){if(e){o(e)}else{o(null,r===0)}}i.deleteTempFiles(p,(function(r){done(e||r)}))}))}}))}},762:e=>{function debug(e,r){if(process.env.DEBUG==="true"){console.log(`::group::${e}`);console.log(JSON.stringify(r,null,3));console.log("::endgroup::")}}e.exports={debug:debug}},649:(e,r,t)=>{"use strict";var n=t(17);var i=t(147);var s=t(113);const{tmpdir:o}=t(37);var a=process.env.PEMJS_TMPDIR||o();e.exports.isNumber=function(e){if(Array.isArray(e)){return false}return/^\d+$/g.test(e)};e.exports.isHex=function isHex(e){return/^(0x){0,1}([0-9A-F]{1,40}|[0-9A-F]{1,40})$/gi.test(e)};e.exports.toHex=function toHex(e){var r="";for(var t=0;t<e.length;t++){r+=""+e.charCodeAt(t).toString(16)}return r};e.exports.ciphers=["aes128","aes192","aes256","camellia128","camellia192","camellia256","des","des3","idea"];var c=e.exports.ciphers;e.exports.createPasswordFile=function(e,r,t){if(!e||!Object.prototype.hasOwnProperty.call(e,"password")||!Object.prototype.hasOwnProperty.call(e,"passType")||!/^(word|in|out)$/.test(e.passType)){return false}var o=n.join(a,s.randomBytes(20).toString("hex"));t.push(o);e.password=e.password.trim();if(e.password===""){e.mustPass=true}if(e.cipher&&c.indexOf(e.cipher)!==-1){r.push("-"+e.cipher)}r.push("-pass"+e.passType);if(e.mustPass){r.push("pass:"+e.password)}else{i.writeFileSync(o,e.password);r.push("file:"+o)}return true};e.exports.deleteTempFiles=function(e,r){var t=[];if(typeof e==="string"){t.push(e)}else if(Array.isArray(e)){t=e}else{return r(new Error("Unexcepted files parameter type; only string or array supported"))}var deleteSeries=function(e,r){if(e.length){var t=e.shift();var myCallback=function(t){if(t&&t.code==="ENOENT"){return deleteSeries(e,r)}else if(t){return r(t)}else{return deleteSeries(e,r)}};if(t&&typeof t==="string"){i.unlink(t,myCallback)}else{return deleteSeries(e,r)}}else{return r(null)}};deleteSeries(t,r)}},702:(e,r,t)=>{var n=t(649);var{debug:i}=t(762);var s=t(81).spawn;var o=t(81).spawnSync;var a=t(17);var c=t(147);const{tmpdir:u}=t(37);var f=t(113);var p=t(143);var l={};var d=process.env.PEMJS_TMPDIR||u();const h=new RegExp("^(OpenSSL|LibreSSL) (((\\d+).(\\d+)).(\\d+))([a-z]+)?");if("DEBUG"in process.env&&process.env.DEBUG==="true"){if("LIBRARY"in process.env&&"VERSION"in process.env&&process.env.LIBRARY!=""&&process.env.VERSION!=""){const e=`./openssl/${process.env.LIBRARY}_v${process.env.VERSION}/bin/openssl`;if(c.existsSync(e)){process.env.OPENSSL_BIN=e}}}function set(e,r){l[e]=r}function get(e){return l[e]||null}function exec(e,r,t,n){if(!n&&typeof t==="function"){n=t;t=false}spawnWrapper(e,t,(function(e,t,i,s){var o,a;if(e){return n(e)}if(o=i.match(new RegExp("-+BEGIN "+r+"-+$","mu"))){o=o.index}else{o=-1}if(r==="EC PARAMETERS"){r="EC PRIVATE KEY"}if(a=i.match(new RegExp("^\\-+END "+r+"\\-+","m"))){a=a.index+a[0].length}else{a=-1}if(o>=0&&a>=0){return n(null,i.substring(o,a))}else{return n(new Error(r+" not found from openssl output:\n---stdout---\n"+i+"\n---stderr---\n"+s+"\ncode: "+t))}}))}function execBinary(e,r,t){if(!t&&typeof r==="function"){t=r;r=false}spawnWrapper(e,r,true,(function(e,r,n,s){i("execBinary",{err:e,code:r,stdout:n,stderr:s});if(e){return t(e)}return t(null,n)}))}function spawn(e,r,t){var n=get("pathOpenSSL")||process.env.OPENSSL_BIN||"openssl";testOpenSSLPath(n,(function(i){if(i){return t(i)}var o=s(n,e);var a="";var c=r?Buffer.alloc(0):"";o.stdout.on("data",(function(e){if(!r){c+=e.toString("binary")}else{c=Buffer.concat([c,e])}}));o.stderr.on("data",(function(e){a+=e.toString("binary")}));var u=2;var f=-1;var p=false;var done=function(r){if(p){return}if(r){p=true;return t(r)}if(--u<1){p=true;if(f!==0){if(f===2&&(a===""||/depth lookup: unable to/.test(a)||/depth lookup: self(-|\s)signed certificate/.test(a))){return t(null,f,c,a)}return t(new Error("Invalid openssl exit code: "+f+"\n% openssl "+e.join(" ")+"\n"+a),f)}else{return t(null,f,c,a)}}};o.on("error",done);o.on("exit",(function(e){f=e;done()}));o.on("close",(function(){c=r?c:Buffer.from(c,"binary").toString("utf-8");a=Buffer.from(a,"binary").toString("utf-8");done()}))}))}function spawnWrapper(e,r,t,s){if(!s&&typeof t==="function"){s=t;t=false}var o=[];var u=[];if(r){r=[].concat(r);var p,l;for(l=0;l<e.length;l++){if(e[l]==="--TMPFILE--"){p=a.join(d,f.randomBytes(20).toString("hex"));o.push({path:p,contents:r.shift()});e[l]=p;u.push(p)}}}var h;for(l=0;l<o.length;l++){h=o[l];c.writeFileSync(h.path,h.contents)}spawn(e,t,(function(r,t,o,a){n.deleteTempFiles(u,(function(n){i(e[0],{err:r,fsErr:n,code:t,stdout:o,stderr:a});s(r||n,t,o,a)}))}))}function testOpenSSLPath(e,r){const t=p.sync(e,{nothrow:true});if(!t){return r(new Error("Could not find openssl on your system on this path: "+e))}r()}function setVersion(){var e=get("pathOpenSSL")||process.env.OPENSSL_BIN||"openssl";var r=o(e,["version"]);var t=String(r.stdout)+"\n"+String(r.stderr)+"\n"+String(r.error);let n=h.exec(t);if(n===null||n.length<=7)return;set("openSslVersion",n[1].toUpperCase());set("Vendor",n[1].toUpperCase());set("VendorVersion",n[2]);set("VendorVersionMajorMinor",n[3]);set("VendorVersionMajor",n[4]);set("VendorVersionMinor",n[5]);set("VendorVersionPatch",n[6]);set("VendorVersionBuildChar",typeof n[7]==="undefined"?"":n[7])}setVersion();e.exports={exec:exec,execBinary:execBinary,spawn:spawn,spawnWrapper:spawnWrapper,settings:l,set:set,get:get}},214:(e,r,t)=>{"use strict";const{debug:n}=t(762);const{createHash:i}=t(5);var s=t(808);var o=t(649);var a=t(702);const hash_md5=e=>{if(Buffer.isBuffer(e)){return i("md5").update(e).digest("hex")}return i("md5").update(String(e),"utf8").digest("hex")};e.exports.createPrivateKey=createPrivateKey;e.exports.createDhparam=createDhparam;e.exports.createEcparam=createEcparam;e.exports.createCSR=createCSR;e.exports.createCertificate=createCertificate;e.exports.readCertificateInfo=readCertificateInfo;e.exports.getPublicKey=getPublicKey;e.exports.getFingerprint=getFingerprint;e.exports.getModulus=getModulus;e.exports.getDhparamInfo=getDhparamInfo;e.exports.createPkcs12=createPkcs12;e.exports.readPkcs12=readPkcs12;e.exports.verifySigningChain=verifySigningChain;e.exports.checkCertificate=checkCertificate;e.exports.checkPkcs12=checkPkcs12;e.exports.config=config;e.exports.convert=t(254);e.exports.CA=t(991);var c="-----BEGIN PRIVATE KEY-----";var u="-----END PRIVATE KEY-----";var f="-----BEGIN RSA PRIVATE KEY-----";var p="-----END RSA PRIVATE KEY-----";var l="-----BEGIN ENCRYPTED PRIVATE KEY-----";var d="-----END ENCRYPTED PRIVATE KEY-----";var h="-----BEGIN CERTIFICATE-----";var m="-----END CERTIFICATE-----";function createPrivateKey(e,r,t){if(!t&&!r&&typeof e==="function"){t=e;e=undefined;r={}}else if(!t&&e&&typeof r==="function"){t=r;r={}}if(!t){return new Promise((function(t,n){createPrivateKey(e,r,(function(e,r){if(e){return n(e)}t(r)}))}))}e=Number(e)||2048;var i=["genrsa"];if(a.get("Vendor")==="OPENSSL"&&a.get("VendorVersionMajor")>=3){i.push("-traditional")}var s=[];if(r&&r.cipher&&Number(o.ciphers.indexOf(r.cipher))!==-1&&r.password){n("helper.createPasswordFile",{cipher:r.cipher,password:r.password,passType:"out"});o.createPasswordFile({cipher:r.cipher,password:r.password,passType:"out"},i,s)}i.push(e);n("version",a.get("openSslVersion"));a.exec(i,"(RSA |ENCRYPTED |)PRIVATE KEY",(function(e,r){function done(e){if(e){return t(e)}return t(null,{key:r})}o.deleteTempFiles(s,(function(t){n("createPrivateKey",{sslErr:e,fsErr:t,key:r,keyLength:r&&r.length});done(e||t)}))}))}function createDhparam(e,r){if(!r&&typeof e==="function"){r=e;e=undefined}if(!r){return new Promise((function(r,t){createDhparam(e,(function(e,n){if(e){return t(e)}r(n)}))}))}e=Number(e)||512;var t=["dhparam","-outform","PEM",e];a.exec(t,"DH PARAMETERS",(function(e,t){if(e){return r(e)}return r(null,{dhparam:t})}))}function createEcparam(e,r,t,n){if(!n&&typeof t==="undefined"&&!r&&typeof e==="function"){n=e;e=undefined}else if(!n&&typeof t==="undefined"&&e&&typeof r==="function"){n=r;r=undefined}else if(!n&&typeof t==="function"&&e&&r){n=t;t=undefined}if(!n){return new Promise((function(n,i){createEcparam(e,r,t,(function(e,r){if(e){return i(e)}n(r)}))}))}e=e||"secp256k1";r=r||"explicit";t=t||false;var i=["ecparam","-name",e,"-genkey","-param_enc",r];var s="EC PARAMETERS";if(t){i.push("-noout");s="EC PRIVATE KEY"}a.exec(i,s,(function(e,r){if(e){return n(e)}return n(null,{ecparam:r})}))}function createCSR(e,r){if(!r&&typeof e==="function"){r=e;e=undefined}if(!r){return new Promise((function(r,t){createCSR(e,(function(e,n){if(e){return t(e)}r(n)}))}))}let t=[];e=e||{};if(e.commonName&&(s.isIPv4(e.commonName)||s.isIPv6(e.commonName))){if(!e.altNames){e.altNames=[e.commonName]}else if(e.altNames.indexOf(e.commonName)===-1){e.altNames=e.altNames.concat([e.commonName])}}if(!e.clientKey){if(e&&(e.password||e.clientKeyPassword)){e.password=e.password||e.clientKeyPassword||""}createPrivateKey(e.keyBitsize||2048,e,(function(t,n){if(t){return r(t)}e.clientKey=n.key;createCSR(e,r)}));return}var n=["req","-new","-"+(e.hash||"sha256")];if(e.csrConfigFile){n.push("-config");n.push(e.csrConfigFile)}else{n.push("-subj");n.push(generateCSRSubject(e))}n.push("-key");n.push("--TMPFILE--");var i=[e.clientKey];var c=null;if(e&&(e.password||e.clientKeyPassword)){o.createPasswordFile({cipher:"",password:e.password||e.clientKeyPassword,passType:"in"},n,t)}if(e.altNames&&Array.isArray(e.altNames)&&e.altNames.length){n.push("-extensions");n.push("v3_req");n.push("-config");n.push("--TMPFILE--");var u=[];for(var f=0;f<e.altNames.length;f++){u.push((s.isIP(e.altNames[f])?"IP":"DNS")+"."+(f+1)+" = "+e.altNames[f])}i.push(c=["[req]","req_extensions = v3_req","distinguished_name = req_distinguished_name","[v3_req]","subjectAltName = @alt_names","[alt_names]",u.join("\n"),"[req_distinguished_name]","commonName = Common Name","commonName_max = 64"].join("\n"))}else if(e.config){c=e.config}if(e.clientKeyPassword){o.createPasswordFile({cipher:"",password:e.clientKeyPassword,passType:"in"},n,t)}a.exec(n,"CERTIFICATE REQUEST",i,(function(n,i){function done(t){if(t){return r(t)}r(null,{csr:i,config:c,clientKey:e.clientKey})}o.deleteTempFiles(t,(function(e){done(n||e)}))}))}function createCertificate(e,r){if(!r&&typeof e==="function"){r=e;e=undefined}if(!r){return new Promise((function(r,t){createCertificate(e,(function(e,n){if(e){return t(e)}r(n)}))}))}e=e||{};if(!e.csr){createCSR(e,(function(t,n){if(t){return r(t)}e.csr=n.csr;e.config=n.config;e.clientKey=n.clientKey;createCertificate(e,r)}));return}if(!e.clientKey){e.clientKey=""}if(!e.serviceKey){if(e.selfSigned){e.serviceKey=e.clientKey}else{createPrivateKey(e.keyBitsize||2048,{cipher:e.cipher,password:e.clientKeyPassword||""},(function(t,n){if(t){return r(t)}e.serviceKey=n.key;createCertificate(e,r)}));return}}readCertificateInfo(e.csr,(function(t,n){if(t){return r(t)}var i=["x509","-req","-"+(e.hash||"sha256"),"-days",Number(e.days)||"365","-in","--TMPFILE--"];var s=[e.csr];var c=[];if(e.serviceCertificate){i.push("-CA");i.push("--TMPFILE--");i.push("-CAkey");i.push("--TMPFILE--");if(e.serial){i.push("-set_serial");if(o.isNumber(e.serial)){i.push("0x"+("0000000000000000000000000000000000000000"+e.serial.toString(16)).slice(-40))}else{if(o.isHex(e.serial)){if(e.serial.startsWith("0x")){e.serial=e.serial.substring(2,e.serial.length)}i.push("0x"+("0000000000000000000000000000000000000000"+e.serial).slice(-40))}else{i.push("0x"+("0000000000000000000000000000000000000000"+o.toHex(e.serial)).slice(-40))}}}else{i.push("-CAcreateserial");if(e.serialFile){i.push("-CAserial");i.push(e.serialFile+".srl")}}if(e.serviceKeyPassword){o.createPasswordFile({cipher:"",password:e.serviceKeyPassword,passType:"in"},i,c)}s.push(e.serviceCertificate);s.push(e.serviceKey)}else{i.push("-signkey");i.push("--TMPFILE--");if(e.serviceKeyPassword){o.createPasswordFile({cipher:"",password:e.serviceKeyPassword,passType:"in"},i,c)}s.push(e.serviceKey)}if(e.config){i.push("-extensions");i.push("v3_req");i.push("-extfile");i.push("--TMPFILE--");s.push(e.config)}else if(e.extFile){i.push("-extfile");i.push(e.extFile)}else{var u=[];if(n&&n.san){for(var f=0;f<n.san.dns.length;f++){u.push("DNS"+"."+(f+1)+" = "+n.san.dns[f])}for(var p=0;p<n.san.ip.length;p++){u.push("IP"+"."+(p+1)+" = "+n.san.ip[p])}for(var l=0;l<n.san.email.length;l++){u.push("email"+"."+(l+1)+" = "+n.san.email[l])}i.push("-extensions");i.push("v3_req");i.push("-extfile");i.push("--TMPFILE--");s.push(["[v3_req]","subjectAltName = @alt_names","[alt_names]",u.join("\n")].join("\n"))}}if(e.clientKeyPassword){o.createPasswordFile({cipher:"",password:e.clientKeyPassword,passType:"in"},i,c)}a.exec(i,"CERTIFICATE",s,(function(t,n){function done(t){if(t){return r(t)}var i={csr:e.csr,clientKey:e.clientKey,certificate:n,serviceKey:e.serviceKey};return r(null,i)}o.deleteTempFiles(c,(function(e){done(t||e)}))}))}))}function getPublicKey(e,r){if(!r&&typeof e==="function"){r=e;e=undefined}if(!r){return new Promise((function(r,t){getPublicKey(e,(function(e,n){if(e){return t(e)}r(n)}))}))}e=(e||"").toString();var t;if(e.match(/BEGIN(\sNEW)? CERTIFICATE REQUEST/)){t=["req","-in","--TMPFILE--","-pubkey","-noout"]}else if(e.match(/BEGIN RSA PRIVATE KEY/)||e.match(/BEGIN PRIVATE KEY/)){t=["rsa","-in","--TMPFILE--","-pubout"]}else{t=["x509","-in","--TMPFILE--","-pubkey","-noout"]}a.exec(t,"PUBLIC KEY",e,(function(e,t){if(e){return r(e)}return r(null,{publicKey:t})}))}function readCertificateInfo(e,r){if(!r&&typeof e==="function"){r=e;e=undefined}if(!r){return new Promise((function(r,t){readCertificateInfo(e,(function(e,n){if(e){return t(e)}r(n)}))}))}e=(e||"").toString();var t=e.match(/BEGIN(\sNEW)? CERTIFICATE REQUEST/);var n=t?"req":"x509";var i=[n,"-noout","-nameopt","RFC2253,sep_multiline,space_eq,-esc_msb,utf8","-text","-in","--TMPFILE--"];a.spawnWrapper(i,e,(function(e,t,n,i){if(e){return r(e)}else if(i){return r(i)}return fetchCertificateData(n,r)}))}function getModulus(e,r,t,n){if(!n&&!t&&typeof r==="function"){n=r;r=undefined;t=false}else if(!n&&t&&typeof t==="function"){n=t;t=false}if(!n){return new Promise((function(n,i){getModulus(e,r,t,(function(e,r){if(e){return i(e)}n(r)}))}))}if(t&&t!=="md5"){t=false}e=Buffer.isBuffer(e)&&e.toString()||e;let i;if(e.match(/BEGIN(\sNEW)? CERTIFICATE REQUEST/)){i="req"}else if(e.match(/BEGIN RSA PRIVATE KEY/)||e.match(/BEGIN PRIVATE KEY/)){i="rsa"}else{i="x509"}let s=[i,"-noout","-modulus","-in","--TMPFILE--"];let c=[];if(r){o.createPasswordFile({cipher:"",password:r,passType:"in"},s,c)}a.spawnWrapper(s,e,(function(e,r,i,s){function done(e){if(e){return n(e)}var r=i.match(/Modulus=([0-9a-fA-F]+)$/m);if(r){if(t==="md5"){return n(null,{modulus:hash_md5(r[1])})}return n(null,{modulus:r[1]})}else{return n(new Error("No modulus"))}}o.deleteTempFiles(c,(function(r){done(e||r||s)}))}))}function getDhparamInfo(e,r){if(!r){return new Promise((function(r,t){getDhparamInfo(e,(function(e,n){if(e){return t(e)}r(n)}))}))}e=Buffer.isBuffer(e)&&e.toString()||e;var t=["dhparam","-text","-in","--TMPFILE--"];a.spawnWrapper(t,e,(function(e,t,n,i){if(e){return r(e)}else if(i){return r(i)}var s={};var o=n.match(/Parameters: \((\d+) bit\)/);if(o){s.size=Number(o[1])}var a="";n.split("\n").forEach((function(e){if(/\s+([0-9a-f][0-9a-f]:)+[0-9a-f]?[0-9a-f]?/g.test(e)){a+=e.trim()}}));if(a){s.prime=a}if(!o&&!a){return r(new Error("No DH info found"))}return r(null,s)}))}function config(e){Object.keys(e).forEach((function(r){a.set(r,e[r])}))}function getFingerprint(e,r,t){if(!t&&typeof r==="function"){t=r;r=undefined}if(!t){return new Promise((function(t,n){getFingerprint(e,r,(function(e,r){if(e){return n(e)}t(r)}))}))}r=r||"sha1";var n=["x509","-in","--TMPFILE--","-fingerprint","-noout","-"+r];a.spawnWrapper(n,e,(function(e,r,n,i){if(e){return t(e)}else if(i){return t(i)}var s=n.match(/Fingerprint=([0-9a-fA-F:]+)$/m);if(s){return t(null,{fingerprint:s[1]})}else{return t(new Error("No fingerprint"))}}))}function createPkcs12(e,r,t,n,i){if(!i&&typeof n==="function"){i=n;n={}}if(!i){return new Promise((function(i,s){createPkcs12(e,r,t,n,(function(e,r){if(e){return s(e)}i(r)}))}))}n=n||{};var s=["pkcs12","-export"];var c=[];if(n.cipher&&n.clientKeyPassword){o.createPasswordFile({cipher:n.cipher,password:n.clientKeyPassword,passType:"in"},s,c)}o.createPasswordFile({cipher:"",password:t,passType:"word"},s,c);s.push("-in");s.push("--TMPFILE--");s.push("-inkey");s.push("--TMPFILE--");var u=[r,e];if(n.certFiles){u.push(n.certFiles.join(""));s.push("-certfile");s.push("--TMPFILE--")}a.execBinary(s,u,(function(e,r){function done(e){if(e){return i(e)}return i(null,{pkcs12:r})}o.deleteTempFiles(c,(function(r){done(e||r)}))}))}function readPkcs12(e,r,t){if(!t&&typeof r==="function"){t=r;r={}}if(!t){return new Promise((function(t,n){readPkcs12(e,r,(function(e,r){if(e){return n(e)}t(r)}))}))}r=r||{};r.p12Password=r.p12Password||"";var i=[];var s=[];var g=["pkcs12","-in",e];o.createPasswordFile({cipher:"",password:r.p12Password,passType:"in"},g,s);if(Buffer.isBuffer(e)){i=[e];g[2]="--TMPFILE--"}if(a.get("Vendor")==="OPENSSL"&&a.get("VendorVersionMajor")>=3){g.push("-legacy");g.push("-traditional")}if(r.clientKeyPassword){o.createPasswordFile({cipher:"",password:r.clientKeyPassword,passType:"out"},g,s)}else{g.push("-nodes")}a.execBinary(g,i,(function(e,i){function done(e){var s={};if(e&&e.message.indexOf("No such file or directory")!==-1){e.code="ENOENT"}if(!e){var o=readFromString(i,h,m);s.cert=o.shift();s.ca=o;s.key=readFromString(i,c,u).pop();n("readPkcs12.execBinary - PRIVATE KEY - ?: ",s.key);if(s.key){var g=["rsa"];if(a.get("Vendor")==="OPENSSL"&&a.get("VendorVersionMajor")>=3){g.push("-traditional")}g.push("-in");g.push("--TMPFILE--");return a.exec(g,"(RSA |)PRIVATE KEY",[s.key],(function(e,r){if(e){n("readPkcs12.execBinary - PRIVATE KEY convert - error: ",e)}s.key=r;return t(e,s)}))}if(r.clientKeyPassword){s.key=readFromString(i,l,d).pop();n("readPkcs12.execBinary - ENCRYPTED PRIVATE KEY - ?: ",s.key)}else{s.key=readFromString(i,f,p).pop();n("readPkcs12.execBinary - RSA PRIVATE KEY - ?: ",s.key)}}return t(e,s)}o.deleteTempFiles(s,(function(r){done(e||r)}))}))}function checkCertificate(e,r,t){var n;var i=[];if(!t&&typeof r==="function"){t=r;r=undefined}if(!t){return new Promise((function(t,n){checkCertificate(e,r,(function(e,r){if(e){return n(e)}t(r)}))}))}e=(e||"").toString();if(e.match(/BEGIN(\sNEW)? CERTIFICATE REQUEST/)){n=["req","-text","-noout","-verify","-in","--TMPFILE--"]}else if(e.match(/BEGIN RSA PRIVATE KEY/)||e.match(/BEGIN PRIVATE KEY/)){n=["rsa","-noout","-check","-in","--TMPFILE--"]}else{n=["x509","-text","-noout","-in","--TMPFILE--"]}if(r){o.createPasswordFile({cipher:"",password:r,passType:"in"},n,i)}a.spawnWrapper(n,e,(function(e,r,s,c){function done(e){s=s&&s.trim();var r;switch(n[0]){case"rsa":r=/^Rsa key ok$/i.test(s);break;default:r=/Signature Algorithm/im.test(s);break}if(!r){if(a.get("Vendor")==="OPENSSL"&&a.get("VendorVersionMajor")>=3){if(!(c&&c.toString().trim().endsWith("verify OK"))){return t(new Error(c.toString()))}}if(e&&e.toString().trim()!=="verify OK"){return t(e)}}t(null,r)}o.deleteTempFiles(i,(function(r){done(e||r||c)}))}))}function checkPkcs12(e,r,t){if(!t&&typeof r==="function"){t=r;r=""}if(!t){return new Promise((function(t,n){checkPkcs12(e,r,(function(e,r){if(e){return n(e)}t(r)}))}))}var i=[];var s=[];var c=["pkcs12","-info","-in",e,"-noout","-maciter","-nodes"];o.createPasswordFile({cipher:"",password:r,passType:"in"},c,s);if(Buffer.isBuffer(e)){i=[e];c[3]="--TMPFILE--"}if(a.get("Vendor")==="OPENSSL"&&a.get("VendorVersionMajor")>=3){c.splice(2,0,"-legacy")}a.spawnWrapper(c,i,(function(e,r,i,a){n("checkPkcs12 error",{err:e,code:r,stdout:i,stdoutResult:/MAC verified OK/im.test(a)||!/MAC verified OK/im.test(a)&&!/Mac verify error/im.test(a),stderr:a});function done(e){if(e){return t(e)}t(null,/MAC verified OK/im.test(a)||!/MAC verified OK/im.test(a)&&!/Mac verify error/im.test(a))}o.deleteTempFiles(s,(function(t){n("checkPkcs12 clean-up error",{sslErr:e,fsErr:t,code:r,stdout:i,stdoutResult:/MAC verified OK/im.test(a)||!/MAC verified OK/im.test(a)&&!/Mac verify error/im.test(a),stderr:a});done(e||t)}))}))}function verifySigningChain(e,r,t){if(!t&&typeof r==="function"){t=r;r=undefined}if(!t){return new Promise((function(t,n){verifySigningChain(e,r,(function(e,r){if(e){return n(e)}t(r)}))}))}if(!Array.isArray(e)){e=readFromString(e,h,m)}if(!Array.isArray(r)&&r!==undefined){if(r!==""){r=[r]}}var i=["verify"];var s=[];if(r!==undefined){i.push("-CAfile");i.push("--TMPFILE--");s.push(r.join("\n"))}var o=e.shift();if(e.length>0){i.push("-untrusted");i.push("--TMPFILE--");s.push(e.join("\n"))}i.push("--TMPFILE--");s.push(o);a.spawnWrapper(i,s,(function(e,r,i,s){n("Vendor",a.get("Vendor"));n("VendorVersionMajor",a.get("VendorVersionMajor"));n("openssl.get('VendorVersionMajor') >= 3",a.get("VendorVersionMajor")>=3);if(a.get("Vendor")==="OPENSSL"&&a.get("VendorVersionMajor")>=3){let o=!!(i&&i.trim().includes(": OK"));if(e){n("verifySigningChain error",{err:e,code:r,stdout:i,stdoutResult:o,stderr:s});return t(e)}n("verifySigningChain error - use stderr",{err:e,code:r,stdout:i.trim(),stdoutResult:o,stderr:s.trim()});return t(null,o)}if(e){n("verifySigningChain error",{err:e,code:r,stdout:i,stdoutResult:i&&i.trim().slice(-4)===": OK",stderr:s});return t(e)}n("verifySigningChain",{err:e,code:r,stdout:i,stdoutResult:i&&i.trim().slice(-4)===": OK",stderr:s});t(null,i&&i.trim().slice(-4)===": OK")}))}function fetchCertificateData(e,r){try{e=(e||"").toString();var t,n,i,s;var o={issuer:{}};var a={};var c;var u,f;if((t=e.match(/\s*Serial Number:\r?\n?\s*([^\r\n]*)\r?\n\s*\b/))&&t.length>1){o.serial=t[1]}if((n=e.match(/\s*Subject:\r?\n(\s*(([a-zA-Z0-9.]+)\s=\s[^\r\n]+\r?\n))*\s*\b/))&&n.length>1){n=n[0];i=matchAll(n,/\s([a-zA-Z0-9.]+)\s=\s([^\r\n].*)/g);if(i){for(f=0;f<i.length;f++){u=i[f][1].trim();if(u.match("(C|ST|L|O|OU|CN|emailAddress|DC)")||u===""){continue}o[u]=i[f][2].trim()}}i=n.match(/\sC\s=\s([^\r\n].*?)[\r\n]/);o.country=i&&i[1]||"";i=n.match(/\sST\s=\s([^\r\n].*?)[\r\n]/);o.state=i&&i[1]||"";i=n.match(/\sL\s=\s([^\r\n].*?)[\r\n]/);o.locality=i&&i[1]||"";i=matchAll(n,/\sO\s=\s([^\r\n].*)/g);o.organization=i?i.length>1?i.sort((function(e,r){var t=e[1].toUpperCase();var n=r[1].toUpperCase();return n>t?-1:t>n?1:0})).sort((function(e,r){return e[1].length-r[1].length})).map((function(e){return e[1]})):i[0][1]:"";i=matchAll(n,/\sOU\s=\s([^\r\n].*)/g);o.organizationUnit=i?i.length>1?i.sort((function(e,r){var t=e[1].toUpperCase();var n=r[1].toUpperCase();return n>t?-1:t>n?1:0})).sort((function(e,r){return e[1].length-r[1].length})).map((function(e){return e[1]})):i[0][1]:"";i=matchAll(n,/\sCN\s=\s([^\r\n].*)/g);o.commonName=i?i.length>1?i.sort((function(e,r){var t=e[1].toUpperCase();var n=r[1].toUpperCase();return n>t?-1:t>n?1:0})).sort((function(e,r){return e[1].length-r[1].length})).map((function(e){return e[1]})):i[0][1]:"";i=matchAll(n,/emailAddress\s=\s([^\r\n].*)/g);o.emailAddress=i?i.length>1?i.sort((function(e,r){var t=e[1].toUpperCase();var n=r[1].toUpperCase();return n>t?-1:t>n?1:0})).sort((function(e,r){return e[1].length-r[1].length})).map((function(e){return e[1]})):i[0][1]:"";i=matchAll(n,/\sDC\s=\s([^\r\n].*)/g);o.dc=i?i.length>1?i.sort((function(e,r){var t=e[1].toUpperCase();var n=r[1].toUpperCase();return n>t?-1:t>n?1:0})).sort((function(e,r){return e[1].length-r[1].length})).map((function(e){return e[1]})):i[0][1]:""}if((s=e.match(/\s*Issuer:\r?\n(\s*([a-zA-Z0-9.]+)\s=\s[^\r\n].*\r?\n)*\s*\b/))&&s.length>1){s=s[0];i=matchAll(s,/\s([a-zA-Z0-9.]+)\s=\s([^\r\n].*)/g);for(f=0;f<i.length;f++){u=i[f][1].toString();if(u.match("(C|ST|L|O|OU|CN|emailAddress|DC)")){continue}o.issuer[u]=i[f][2].toString()}i=s.match(/\sC\s=\s([^\r\n].*?)[\r\n]/);o.issuer.country=i&&i[1]||"";i=s.match(/\sST\s=\s([^\r\n].*?)[\r\n]/);o.issuer.state=i&&i[1]||"";i=s.match(/\sL\s=\s([^\r\n].*?)[\r\n]/);o.issuer.locality=i&&i[1]||"";i=matchAll(s,/\sO\s=\s([^\r\n].*)/g);o.issuer.organization=i?i.length>1?i.sort((function(e,r){var t=e[1].toUpperCase();var n=r[1].toUpperCase();return n>t?-1:t>n?1:0})).sort((function(e,r){return e[1].length-r[1].length})).map((function(e){return e[1]})):i[0][1]:"";i=matchAll(s,/\sOU\s=\s([^\r\n].*)/g);o.issuer.organizationUnit=i?i.length>1?i.sort((function(e,r){var t=e[1].toUpperCase();var n=r[1].toUpperCase();return n>t?-1:t>n?1:0})).sort((function(e,r){return e[1].length-r[1].length})).map((function(e){return e[1]})):i[0][1]:"";i=matchAll(s,/\sCN\s=\s([^\r\n].*)/g);o.issuer.commonName=i?i.length>1?i.sort((function(e,r){var t=e[1].toUpperCase();var n=r[1].toUpperCase();return n>t?-1:t>n?1:0})).sort((function(e,r){return e[1].length-r[1].length})).map((function(e){return e[1]})):i[0][1]:"";i=matchAll(s,/\sDC\s=\s([^\r\n].*)/g);o.issuer.dc=i?i.length>1?i.sort((function(e,r){var t=e[1].toUpperCase();var n=r[1].toUpperCase();return n>t?-1:t>n?1:0})).sort((function(e,r){return e[1].length-r[1].length})).map((function(e){return e[1]})):i[0][1]:""}if((c=e.match(/X509v3 Subject Alternative Name: \r?\n([^\r\n]*)\r?\n/))&&c.length>1){c=c[1].trim()+"\n";o.san={};i=pregMatchAll("DNS:([^,\\r\\n].*?)[,\\r\\n\\s]",c);o.san.dns=i||"";i=pregMatchAll("IP Address:([^,\\r\\n].*?)[,\\r\\n\\s]",c);o.san.ip=i||"";i=pregMatchAll("email:([^,\\r\\n].*?)[,\\r\\n\\s]",c);o.san.email=i||""}if((i=e.match(/Not Before\s?:\s?([^\r\n]*)\r?\n/))&&i.length>1){a.start=Date.parse(i&&i[1]||"")}if((i=e.match(/Not After\s?:\s?([^\r\n]*)\r?\n/))&&i.length>1){a.end=Date.parse(i&&i[1]||"")}if(a.start&&a.end){o.validity=a}if((i=e.match(/Signature Algorithm: ([^\r\n]*)\r?\n/))&&i.length>1){o.signatureAlgorithm=i&&i[1]||""}if((i=e.match(/Public[ -]Key: ([^\r\n]*)\r?\n/))&&i.length>1){o.publicKeySize=(i&&i[1]||"").replace(/[()]/g,"")}if((i=e.match(/Public Key Algorithm: ([^\r\n]*)\r?\n/))&&i.length>1){o.publicKeyAlgorithm=i&&i[1]||""}r(null,o)}catch(e){r(e)}}function matchAll(e,r){var t=[];e.replace(r,(function(){var e=[].slice.call(arguments,0);var r=e.splice(-2);e.index=r[0];e.input=r[1];t.push(e)}));return t.length?t:null}function pregMatchAll(e,r){var t=new RegExp(e,"g");var n=r.match(t)||[];var i=[];var s,o;for(var a=0;a<n.length;a++){s=new RegExp(e);o=n[a].match(s);i.push(o[1])}return i}function generateCSRSubject(e){e=e||{};var r={C:e.country||e.C,ST:e.state||e.ST,L:e.locality||e.L,O:e.organization||e.O,OU:e.organizationUnit||e.OU,CN:e.commonName||e.CN||"localhost",DC:e.dc||e.DC||"",emailAddress:e.emailAddress};var t=Object.keys(r).map((function(e){if(r[e]){if(typeof r[e]==="object"&&r[e].length>=1){var t="";r[e].map((function(r){t+="/"+e+"="+r.replace(/[^\w\s-!$%^&*()_+|~=`{}[\]:/;<>?,.@#]+/g," ").replace("/","\\/").replace("+","\\+").trim()}));return t}else{return"/"+e+"="+r[e].replace(/[^\w\s-!$%^&*()_+|~=`{}[\]:/;<>?,.@#]+/g," ").replace("/","\\/").replace("+","\\+").trim()}}}));return t.join("")}function readFromString(e,r,t){if(Buffer.isBuffer(e)){e=e.toString("utf8")}var n=[];if(!e){return n}var i=e.indexOf(r);while(i!==-1){e=e.substring(i);var s=e.indexOf(t);if(s===-1){break}s+=t.length;n.push(e.substring(0,s));i=e.indexOf(r,s)}return n}var g=["createPrivateKey","createDhparam","createEcparam","createCSR","createCertificate","readCertificateInfo","getPublicKey","getFingerprint","getModulus","getDhparamInfo","createPkcs12","readPkcs12","verifySigningChain","checkCertificate","checkPkcs12"];e.exports.promisified=g.reduce((function(r,t){r[t]=function(){var r=Array.prototype.slice.call(arguments);if(r.length&&typeof r[r.length-1]==="function"){r=r.slice(0,-1)}return e.exports[t].apply(null,r)};return r}),{})},200:function(e,r,t){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,r,t,n){if(n===undefined)n=t;var i=Object.getOwnPropertyDescriptor(r,t);if(!i||("get"in i?!r.__esModule:i.writable||i.configurable)){i={enumerable:true,get:function(){return r[t]}}}Object.defineProperty(e,n,i)}:function(e,r,t,n){if(n===undefined)n=t;e[n]=r[t]});var i=this&&this.__setModuleDefault||(Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:true,value:r})}:function(e,r){e["default"]=r});var s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(e!=null)for(var t in e)if(t!=="default"&&Object.prototype.hasOwnProperty.call(e,t))n(r,e,t);i(r,e);return r};var o=this&&this.__exportStar||function(e,r){for(var t in e)if(t!=="default"&&!Object.prototype.hasOwnProperty.call(r,t))n(r,e,t)};Object.defineProperty(r,"__esModule",{value:true});r.sync=r.isexe=r.posix=r.win32=void 0;const a=s(t(523));r.posix=a;const c=s(t(323));r.win32=c;o(t(252),r);const u=process.env._ISEXE_TEST_PLATFORM_||process.platform;const f=u==="win32"?c:a;r.isexe=f.isexe;r.sync=f.sync},252:(e,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:true})},523:(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:true});r.sync=r.isexe=void 0;const n=t(147);const i=t(292);const isexe=async(e,r={})=>{const{ignoreErrors:t=false}=r;try{return checkStat(await(0,i.stat)(e),r)}catch(e){const r=e;if(t||r.code==="EACCES")return false;throw r}};r.isexe=isexe;const sync=(e,r={})=>{const{ignoreErrors:t=false}=r;try{return checkStat((0,n.statSync)(e),r)}catch(e){const r=e;if(t||r.code==="EACCES")return false;throw r}};r.sync=sync;const checkStat=(e,r)=>e.isFile()&&checkMode(e,r);const checkMode=(e,r)=>{const t=r.uid??process.getuid?.();const n=r.groups??process.getgroups?.()??[];const i=r.gid??process.getgid?.()??n[0];if(t===undefined||i===undefined){throw new Error("cannot get uid or gid")}const s=new Set([i,...n]);const o=e.mode;const a=e.uid;const c=e.gid;const u=parseInt("100",8);const f=parseInt("010",8);const p=parseInt("001",8);const l=u|f;return!!(o&p||o&f&&s.has(c)||o&u&&a===t||o&l&&t===0)}},323:(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:true});r.sync=r.isexe=void 0;const n=t(147);const i=t(292);const isexe=async(e,r={})=>{const{ignoreErrors:t=false}=r;try{return checkStat(await(0,i.stat)(e),e,r)}catch(e){const r=e;if(t||r.code==="EACCES")return false;throw r}};r.isexe=isexe;const sync=(e,r={})=>{const{ignoreErrors:t=false}=r;try{return checkStat((0,n.statSync)(e),e,r)}catch(e){const r=e;if(t||r.code==="EACCES")return false;throw r}};r.sync=sync;const checkPathExt=(e,r)=>{const{pathExt:t=process.env.PATHEXT||""}=r;const n=t.split(";");if(n.indexOf("")!==-1){return true}for(let r=0;r<n.length;r++){const t=n[r].toLowerCase();const i=e.substring(e.length-t.length).toLowerCase();if(t&&i===t){return true}}return false};const checkStat=(e,r,t)=>e.isFile()&&checkPathExt(r,t)}};var r={};function __nccwpck_require__(t){var n=r[t];if(n!==undefined){return n.exports}var i=r[t]={exports:{}};var s=true;try{e[t].call(i.exports,i,i.exports,__nccwpck_require__);s=false}finally{if(s)delete r[t]}return i.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var t=__nccwpck_require__(214);module.exports=t})();
//# sourceMappingURL=index.js.map